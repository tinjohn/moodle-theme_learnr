define("theme_learnr/dynprbar",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;_exports.init=()=>{window.addEventListener("load",(function(){var pr=document.getElementsByClassName("progress")[0];const prbar=document.getElementsByClassName("progress-bar progress-bar-info")[0];alert("pr"+pr),alert("prbar"+prbar)}));let send=XMLHttpRequest.prototype.send;const prbar=document.getElementsByClassName("progress-bar progress-bar-info")[0];function readAJAXrequestsend(payload){var isValidJSON=!0;try{JSON.parse(payload)}catch{isValidJSON=!1}if(isValidJSON){const plo=JSON.parse(payload);if(plo[0].methodname.match("(.*)core_completion_update_activity_completion_status_manually(.*)"))if(plo[0].args.completed)addProgress();else{var newwidth=parseInt(prbar.style.width)-parseInt(prbar.getAttribute("progress-steps"));if(parseInt(prbar.style.width)-parseInt(prbar.getAttribute("progress-steps"))<0)newwidth=0;prbar.style.width=newwidth+"%"}if(plo[0].methodname.match("(.*)core_xapi_statement_post(.*)")){isValidJSON=!0;try{JSON.parse(plo[0].args.requestjson)}catch{isValidJSON=!1}if(isValidJSON){const xapiReq=JSON.parse(plo[0].args.requestjson);if(xapiReq[0].result.completion&&xapiReq[0].result.success){var contextid=xapiReq[0].object.id,sender=xapiReq[0].actor.account.homepage;window.parent.postMessage({method:"addProgress",contextid:contextid},sender)}}}payload=""}}function addProgress(contextid){const iframeprbar=document.getElementsByClassName("progress-bar progress-bar-info")[0];if(null!==iframeprbar){if(null!==contextid){if(iframeprbar.getAttribute("completedmods").match("(.*)"+contextid+"(.*)"))return}iframeprbar.style.width=parseInt(iframeprbar.style.width)+parseInt(iframeprbar.getAttribute("progress-steps"))+"%"}}XMLHttpRequest.prototype.send=function(){var payload=arguments[0];if(null!==payload){alert("arguments 0 send-----"+payload);var isValidJSON=!0;try{JSON.parse(payload)}catch{isValidJSON=!1}isValidJSON&&this.addEventListener("load",(function removeMe(){readAJAXrequestsend(payload),this.removeEventListener("load",removeMe)}),!1),send.apply(this,arguments)}else send.apply(this,arguments)},window.addEventListener("message",(function(e){if("addProgress"==e.data.method){const[,contextid]=e.data.contextid.split(/\/(?=[^\/]+$)/);addProgress(contextid)}}))}}));

//# sourceMappingURL=dynprbar.min.js.map